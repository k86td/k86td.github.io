# Pods

C'est la resource la plus petite qui peut √™tre contr√¥ler par [[1. Kubernetes]]. Elle sert √† contr√¥ler 1 ou plusieurs container. La documentation de cette ressource ce trouve [ici](https://kubernetes.io/docs/concepts/workloads/pods/).

## R√©seau et Storage

Dans un Pod, les containers obtiennent une interface IP gr√¢ce au container `Pause`. Un ou plusieurs volumes peuvent √™tre attacher au Pod. Toutefois, il faut sp√©cifier le chemin o√π le volume doit √™tre attach√©. Voir [ici](https://kubernetes.io/docs/tasks/configure-pod-container/configure-volume-storage/) pour des exemples de comment attacher des volumes sur un Pod.

![[bfd5haac3htu-Kubernetes-Network-Pod-2.png]]

## Configuration Scheduler

Il est possible de configurer les pr√©f√©rences de node pour le Pod. Il y a plusieurs choix.

### NodeName

Ce param√®tre contient le nom du Node que le Pod devrait s'ex√©cuter. Le scheduler ajoute ce param√®tre lorsqu'il √† choisis la node id√©al, mais il est possible de forcer une node en ajoutant le param√®tre manuellement.

### NodeSelector

C'est un s√©lecteur bas√©e sur les labels du Node. [Voici](https://kubernetes.io/docs/tasks/configure-pod-container/assign-pods-nodes/#create-a-pod-that-gets-scheduled-to-your-chosen-node) un exemple de la documentation.

### Affinity & Anti-Affinity

Ces plus complexe que les autres param√®tres.

### Topology Spread Constraint

- [ ] Test out `PodTopologySpread` üîΩ #test
- [ ] Rewrite `PodTopologySpread` üîΩ #rewrite  

## Scheduling

Il est possible de configurer comment un Pod sera assign√© √† une node. C'est des param√®tre qui seront utilis√© avec [[Kube-Scheduler]].
### NodeName et NodeSelector
C'est des champs qui permettent √† un Pod d'assigner directement la node (ou groupe de nodes) sur laquelle il sera h√©berger.
NodeSelector cherche dans les cl√©/valeur des labels des nodes.
### Affinity et Anti-Affinity
√áa permet √† d√©finir une pr√©f√©rence au Pod. Si aucune node qu'il aurait pr√©f√©rer est disponible, il en utilisera une autre. La configuration se fais dans `spec.affinity` d'un PodSpec.
Affinity et Anti-Affinity utilise les labels des nodes. `podAffinity` essaie de mettre des Pods aussi pr√®s que possible, `podAntiAffinity` fais l'inverse.
Il √©galement possible de d√©finir des r√®gles de `NodeAffinity`. 
### Taints et Tolerations
Une node peut avoir une [[20230717-10.07 - Taints|Teinte]] qui ne permet pas √† Pod de se faire assigner sur cette node. C'est dans le champs `tolerations` d'un PodSpec qu'on peut autoris√© un Pod √† se faire assign√© sur une node qui √† une teinte.
### SchedulerName
Si aucun des param√®tres plus haut permet assez de flexibilit√©, un scheduler custom peut √™tre assign√©.